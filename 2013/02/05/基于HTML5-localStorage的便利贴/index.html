<!doctype html>
<html class="theme-next use-motion ">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.4"/>


    <meta name="description" content="晓风博客是一个以技术成长、设计生活、个人心得为主题的个人博客，旨在与你分享生活点滴，共同成长。" />



  <meta name="keywords" content="科技改变生活," />



  <link rel="alternate" href="/atom.xml" title="晓风博客" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.4" />


<meta content="晓风博客" property="og:site_name">
<meta content="基于HTML5 localStorage的便利贴" property="og:title">
<meta content="http://liyaodong.com/2013/02/05/基于HTML5-localStorage的便利贴/" property="og:url">
<meta content="article" property="og:type">
<meta content="晓风博客是一个以技术成长、设计生活、个人心得为主题的个人博客，旨在与你分享生活点滴，共同成长。" property="og:description">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    analytics: {
      google: 'UA-30027709-1'
    },
    sidebar: 'hide'
  };
</script>




  <title> 基于HTML5 localStorage的便利贴 // 晓风博客 </title>
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>
</head>

<body>
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  <div class="container one-column page-post-detail">
    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <span class="logo windmill-logo">
    <i class="windmill-top"></i>
    <i class="windmill-dot"></i>
    <i class="windmill-base"></i>
  </span>
  <a href="/" class="brand windmill-hover">
    <span class="site-title">晓风博客</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<div class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/">
            <i class="menu-item-icon icon-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            <i class="menu-item-icon icon-archives"></i> <br />
            归档
          </a>
        </li>
      
    </ul>
  

  
</div>

      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          

  <div id="posts" class="posts-expand">
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              基于HTML5 localStorage的便利贴
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于 2013-02-05
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2013/02/05/基于HTML5-localStorage的便利贴/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/02/05/基于HTML5-localStorage的便利贴/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        <p>放寒假了，整日昏昏欲睡，实在无聊。今天看了一会书，忽然发现一个让自己感兴趣的玩意——HTML5 localStorage，于是花了一下午加半晚上的时间完成了这个应用。<a id="more"></a></p>
<p>很多该说的，该写的已经在源码里了。相信大家都和我一样，喜欢看源码。源码来的直接一点。遂奉上源码，当然还有整个项目的百度网盘地址，由于只使用了3张很小的图片，遂整个应用显的很苗条，压缩之后只剩下156KB了。</p>
<h3 id="应用地址：http-liyaodong-sinaapp-com-localStorage"><a href="#应用地址：http-liyaodong-sinaapp-com-localStorage" class="headerlink" title="应用地址：http://liyaodong.sinaapp.com/localStorage/"></a>应用地址：<a href="http://liyaodong.sinaapp.com/localStorage/" target="_blank" rel="external">http://liyaodong.sinaapp.com/localStorage/</a></h3><h3 id="百度网盘源码下载：http-pan-baidu-com-share-link-shareid-249047-amp-uk-3171893396"><a href="#百度网盘源码下载：http-pan-baidu-com-share-link-shareid-249047-amp-uk-3171893396" class="headerlink" title="百度网盘源码下载：http://pan.baidu.com/share/link?shareid=249047&amp;uk=3171893396"></a>百度网盘源码下载：<a href="http://pan.baidu.com/share/link?shareid=249047&amp;uk=3171893396" target="_blank" rel="external">http://pan.baidu.com/share/link?shareid=249047&amp;uk=3171893396</a></h3><p>Tip:源码下来后直接是看不到效果的，localStorage需要服务器的支持。wamp搭建个临时的吧。</p>
<p><a href="http://liyaodong.qiniudn.com/uploads/2013/02/应用截图.jpg" target="_blank" rel="external"><img src="http://liyaodong.qiniudn.com/uploads/2013/02/应用截图.jpg" alt="应用截图" title="应用截图"></a></p>
<h3 id="技术难点分析："><a href="#技术难点分析：" class="headerlink" title="技术难点分析："></a>技术难点分析：</h3><p>首先就是localStorage了，localStorage就是一个基于客户端的数据库吧，可以这么说。但是这个数据库只能放点不是很重要的玩意，如果你放进去账号密码。那么再删除浏览器或者更换浏览器或者清空缓存或者重装系统之后，恭喜你，你就杯具了。localStorage允许我们在客户端，即浏览器内存储5MB的数据。神马？才5MB？太小气了吧。起初我也这么认为，但是当我支持Cookies只支持4K之后我突然觉得HTML5已经很大方了。毕竟是客户端嘛，相对于Cookies来说，localStorage有更大的空间，更长的生命周期。可以存储更多的东西，这会使你的应用看起来更像应用一点。不是吗？</p>
<p>那么localStorage到底怎么看呢？打开你的Chrome，不要给我说你还在用IE6，请使用支持HTML5的浏览器，例如Chrome、Safari、猎豹、360急速、搜狗等国产浏览器的急速模式。也就是webkit，因为我没有针对火狐和IE这2B做优化。所以应该是看不了的，推荐使用webkit内核的浏览器查看。如果你确定是webkit内核了，请按F12，打开审查元素，点击Resources看左侧的Local Storage，选中你查看的网站的域就可以了。需要注意的是localStorage需要有服务器的支持，没有服务器的亲可以下载wamp或者phpnow之类的。</p>
<p><a href="http://liyaodong.qiniudn.com/uploads/2013/02/审查元素.png" target="_blank" rel="external"><img src="http://liyaodong.qiniudn.com/uploads/2013/02/审查元素.png" alt="" title="审查元素"></a></p>
<p>如果你在即时贴中输入数据就可以看到localStorage中有数据了。</p>
<p>难点二就是让颜色随机的很好看了，这个是通过控制HSL颜色模式中的H来达到目的的，HSL和RGB、HSB一样都是一种颜色模式，而且CSS原生支持HSL，起初我还在为RGB转HSB的公式而头疼，我这人不喜欢数学。但是RGB转HSB的公式让我想起了我蛋疼的高数。正在沮丧之时我看到CSS的手册中颜色模式有HSL，就差一个B，估计也2不到哪去。然后研究了一下发现HSL和HSB很像，但只是很像，具体区别请找度娘。</p>
<p>难点三呢就是没有了，其他的CSS、响应式WEB都不算难点，因为写JS是最花时间和脑细胞的。看起来就会觉得头疼。不是吗？</p>
<p>下面不废话了，奉上源码，给不能再百度网盘下载源码的亲们，希望大家寒假都能有所收获：</p>
<h3 id="HTML源码："><a href="#HTML源码：" class="headerlink" title="HTML源码："></a>HTML源码：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&amp;lt;!doctype html&amp;gt;</div><div class="line">&amp;lt;html lang=&amp;quot;zh_cn&amp;quot;&amp;gt;</div><div class="line">&amp;lt;head&amp;gt;</div><div class="line">	&amp;lt;title&amp;gt;HTML5 localStorage 便利贴&amp;lt;/title&amp;gt;</div><div class="line">	&amp;lt;meta charset=&amp;quot;UTF-8&amp;quot; /&amp;gt;</div><div class="line">	&amp;lt;meta name=&amp;quot;author&amp;quot; content=&amp;quot;晓风东东&amp;quot; /&amp;gt;</div><div class="line">	&amp;lt;meta name=&amp;quot;keywords&amp;quot; content=&amp;quot;HTML5,locaStorage,HSL,便利贴,即时贴&amp;quot; /&amp;gt;</div><div class="line">	&amp;lt;meta name=&amp;quot;description&amp;quot; content=&amp;quot;一个基于HTML5和CSS3技术的便利贴应用，你可以写入一些待办事项。这些东西会完整的保存在你的浏览器里，除非你清空缓存。&amp;quot; /&amp;gt;</div><div class="line">	&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;css/style.css&amp;quot;&amp;gt;</div><div class="line">	&amp;lt;!--[if lt IE 9]&amp;gt;</div><div class="line">		&amp;lt;script src=&amp;quot;http://html5shiv.googlecode.com/svn/trunk/html5.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;</div><div class="line">	&amp;lt;![endif]--&amp;gt;</div><div class="line">	&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;js/jquery.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;</div><div class="line">	&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;js/js.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;</div><div class="line">&amp;lt;/head&amp;gt;</div><div class="line">	&amp;lt;body&amp;gt;</div><div class="line">		&amp;lt;section id=&amp;quot;shell&amp;quot;&amp;gt;</div><div class="line">			&amp;lt;form id=&amp;quot;ctrl_form&amp;quot;&amp;gt;</div><div class="line">				&amp;lt;div id=&amp;quot;title&amp;quot;&amp;gt;HTML5 localStorage 便利贴&amp;lt;/div&amp;gt;</div><div class="line">				&amp;lt;label for=&amp;quot;note_color&amp;quot;&amp;gt;颜色：&amp;lt;/label&amp;gt;</div><div class="line">				&amp;lt;select id=&amp;quot;note_color&amp;quot;&amp;gt;</div><div class="line">					&amp;lt;option&amp;gt;随机&amp;lt;/option&amp;gt;</div><div class="line">					&amp;lt;option&amp;gt;科技蓝&amp;lt;/option&amp;gt;</div><div class="line">					&amp;lt;option&amp;gt;淡雅黄&amp;lt;/option&amp;gt;</div><div class="line">					&amp;lt;option&amp;gt;清新绿&amp;lt;/option&amp;gt;</div><div class="line">					&amp;lt;option&amp;gt;暧昧粉&amp;lt;/option&amp;gt;</div><div class="line">					&amp;lt;option&amp;gt;高贵紫&amp;lt;/option&amp;gt;</div><div class="line">				&amp;lt;/select&amp;gt;</div><div class="line">				&amp;lt;input type=&amp;quot;text&amp;quot; id=&amp;quot;note_text&amp;quot; /&amp;gt;</div><div class="line">				&amp;lt;input type=&amp;quot;button&amp;quot; id=&amp;quot;add_btn&amp;quot; value=&amp;quot;增加&amp;quot; /&amp;gt;</div><div class="line">			&amp;lt;/form&amp;gt;</div><div class="line">			&amp;lt;section id=&amp;quot;note_display&amp;quot;&amp;gt;</div><div class="line">				&amp;lt;ul id=&amp;quot;note_display_ul&amp;quot;&amp;gt;</div><div class="line">				&amp;lt;/ul&amp;gt;</div><div class="line">			&amp;lt;/section&amp;gt;&amp;lt;!--note_display end--&amp;gt;</div><div class="line">		&amp;lt;/section&amp;gt;&amp;lt;!--shell end--&amp;gt;</div><div class="line">	&amp;lt;/body&amp;gt;</div><div class="line"></div><div class="line">&amp;lt;/html&amp;gt;</div></pre></td></tr></table></figure>
<h3 id="CSS源码："><a href="#CSS源码：" class="headerlink" title="CSS源码："></a>CSS源码：</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line">/* -----Copyright (c) 2012, KINGWELL Inc.  All rights reserved. V1.2----- */</div><div class="line">html,body&#123;background:#FFF; color:#000; font: normal normal normal 12px/1 Arial, Helvetica, sans-serif; margin:0; padding:0&#125;</div><div class="line">a,abbr,acronym,address,applet,article,b,big,blockquote,button,canvas,caption,center,cite,code,dd,del,dfn,div,dl,dt,em,embed,fieldset,font,form,h1,h2,h3,h4,h5,h6,hr,html,nav,i,iframe,img,ins,input,kbd,label,legend,li,menu,object,ol,p,pre,q,s,samp,small,span,section,strike,strong,sub,sup,table,textarea,tbody,td,tfoot,th,thead,tr,tt,u,ul,var&#123;margin:0;padding:0; font-size:100%&#125;</div><div class="line">table&#123;border-collapse:collapse; border-spacing:0&#125;</div><div class="line">fieldset,img&#123;border:none&#125;</div><div class="line">img&#123;vertical-align:middle; outline:none&#125;</div><div class="line">q:before,q:after&#123;content:''&#125;p&#123;margin:10px auto&#125;</div><div class="line">h1,h2,h3,h4,h5,h6&#123;font-size:100%; font-weight:normal&#125;</div><div class="line">h1&#123;font-size:18px;&#125;h2&#123;font-size:16px;&#125;h3&#123;font-size:14px;&#125;h4&#123;font-size:12px;&#125;h5&#123;font-size:10px;&#125;</div><div class="line">li&#123;list-style:none&#125;ol&#123;padding-left:20px&#125;ol li&#123;list-style-type:decimal;&#125;</div><div class="line">sup&#123;vertical-align:text-top;&#125;sub&#123;vertical-align:text-bottom;&#125;strong&#123;font-weight:bold;&#125;</div><div class="line">input[type=submit],input[type=button],button,input[type=image]&#123;cursor:pointer;&#125;</div><div class="line">input[type=text],input[type=password],textarea&#123;border:1px solid #CCC; line-height:1&#125;</div><div class="line">input[type=text]:focus,input[type=password]:focus,textarea:focus,select:focus&#123;background:#FFF9D9; border:1px solid orange; box-shadow:0 1px 2px #CCC inset&#125;</div><div class="line">input[type=radio],input[type=checkbox]&#123;vertical-align:middle;&#125;</div><div class="line">a:link&#123;color:#000;text-decoration:none;&#125;</div><div class="line">a:visited&#123;text-decoration:none;color:#333;&#125;</div><div class="line">a:hover&#123;text-decoration:underline; color:#00C;&#125;</div><div class="line">a:active&#123;text-decoration:none;color:#333;&#125;</div><div class="line">.clear-float&#123;clear:both;line-height:0;height:0;overflow:hidden&#125;</div><div class="line">.c-l&#123;clear:left&#125;.c-r&#123;clear:right&#125;</div><div class="line">::selection&#123;background:green; color:white;&#125;</div><div class="line">:after&#123;clear:both; content:&amp;quot;.&amp;quot;; display:block; visibility:hidden; height:0; line-height:0;&#125;</div><div class="line">/*--CSS Reset End--*/</div><div class="line">html,body &#123;</div><div class="line">	background:url(../images/bg.png);</div><div class="line">	font-family:&amp;quot;微软雅黑&amp;quot;;</div><div class="line">&#125;</div><div class="line">#ctrl_form &#123;</div><div class="line">	background:-webkit-gradient(linear, 0 0, 0 100%, from(#2c2f36), to(#16181c));</div><div class="line">	width:60%;</div><div class="line">	border-radius:5px;</div><div class="line">	margin:0 auto;</div><div class="line">	margin-top:5%;</div><div class="line">	text-align:center;</div><div class="line">	padding:1%;</div><div class="line">	color:#fff;</div><div class="line">&#125;</div><div class="line">#title &#123;</div><div class="line">	font-size:200%;</div><div class="line">	padding-bottom:10px;</div><div class="line">	margin-bottom:10px;</div><div class="line">	border-bottom:2px dashed #888;</div><div class="line">	text-shadow:2px 1px 2px #888;</div><div class="line">&#125;</div><div class="line">#note_display &#123;</div><div class="line">	width:90%;</div><div class="line">	margin:0 auto;</div><div class="line">	text-align:center;</div><div class="line">	margin-top:5%;</div><div class="line">&#125;</div><div class="line">#note_display ul li &#123;</div><div class="line">	width:10%;</div><div class="line">	background:hsl(110,53%,60%);</div><div class="line">	background-image:url(../images/wangge.png);</div><div class="line">	height:150px;</div><div class="line">	float:left;</div><div class="line">	border:1px solid #aeaeae;</div><div class="line">	color:#222;</div><div class="line">	font-size:150%;</div><div class="line">	padding:1%;</div><div class="line">	margin:1%;</div><div class="line">	cursor:pointer;</div><div class="line">	overflow:hidden;</div><div class="line">	box-shadow: 2px 2px 8px #222;</div><div class="line">&#125;</div><div class="line">#note_display ul li:hover &#123;</div><div class="line">	opacity:.8;</div><div class="line">&#125;</div><div class="line">#add_btn,#note_text,#note_color,label &#123;</div><div class="line">	font-family:&amp;quot;微软雅黑&amp;quot;;</div><div class="line">	font-size:150%;</div><div class="line">	padding:.5%;</div><div class="line">&#125;</div><div class="line">#note_color &#123;</div><div class="line">	padding:.4%;</div><div class="line">&#125;</div><div class="line">#add_btn &#123;</div><div class="line">	background:-webkit-gradient(linear, 0 0, 0 100%, from(#aeaeae), to(#888));</div><div class="line">	border:1px solid #aeaeae;</div><div class="line">	color:#000;</div><div class="line">&#125;</div><div class="line">#add_btn:hover &#123;</div><div class="line">	background:-webkit-gradient(linear, 0 0, 0 100%, from(#888), to(#aeaeae));</div><div class="line">&#125;</div><div class="line">#note_text &#123;</div><div class="line">	width:30%;</div><div class="line">&#125;</div><div class="line">/*响应式web设计的核心，为不同设备屏幕写出独立的CSS，同时尽量避免使用PX作为宽度的单位，更多的使用相对单位。*/</div><div class="line">@media screen and (max-width:720px) &#123;</div><div class="line">	#note_display ul li &#123;</div><div class="line">		width:20%;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">@media screen and (max-width:480px) &#123;</div><div class="line">	#note_display ul li &#123;</div><div class="line">		width:40%;</div><div class="line">		font-size:120%;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="终于要到了最头疼的JS源码了，不过也是最有技术含量的部分："><a href="#终于要到了最头疼的JS源码了，不过也是最有技术含量的部分：" class="headerlink" title="终于要到了最头疼的JS源码了，不过也是最有技术含量的部分："></a>终于要到了最头疼的JS源码了，不过也是最有技术含量的部分：</h3><p>&nbsp;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()&#123;</div><div class="line">	//给增加按钮绑定事件，并设置在点击增加后输入框内清空</div><div class="line">	$(&amp;quot;#add_btn&amp;quot;).click(function()&#123;</div><div class="line">		var note_text_val = $(&amp;quot;#note_text&amp;quot;).val();</div><div class="line">		if (note_text_val == &amp;quot;&amp;quot;)&#123;</div><div class="line">			alert(&amp;quot;亲，你还没有填写任何内容喔！&amp;quot;);</div><div class="line">		&#125;</div><div class="line">		else &#123;</div><div class="line">			createSticky();</div><div class="line">			$(&amp;quot;#note_text&amp;quot;).val(&amp;quot;&amp;quot;);</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">	//遍历便利贴数组，同时传递值给其他函数</div><div class="line">	//JSON.parse是个非常神奇的函数，可以给你把数组或者对象的内容转化为字符串。就像JSON那样，很棒！这使的我可以在Cookies或者localStore中存储更多的数据</div><div class="line">	var stickiesArray = getStickiesArray();</div><div class="line">	for(var i= 0 ; i &amp;lt; stickiesArray.length;  i++)&#123;</div><div class="line">		var key = stickiesArray[i];</div><div class="line">		var value = JSON.parse(localStorage[key]);</div><div class="line">		addStickyToDOM(key, value);</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line">//创建stickiesArray，存放一个类似电话本的键，并且对localStorage中的stickiesArray这个“母键”初始化</div><div class="line">function getStickiesArray() &#123;</div><div class="line">	var stickiesArray = localStorage[&amp;quot;stickiesArray&amp;quot;];</div><div class="line">	if(!stickiesArray) &#123;</div><div class="line">		stickiesArray = [];</div><div class="line">		localStorage.setItem(&amp;quot;stickiesArray&amp;quot;, JSON.stringify(stickiesArray));</div><div class="line">	&#125;</div><div class="line">	else &#123;</div><div class="line">		stickiesArray = JSON.parse(stickiesArray);</div><div class="line">	&#125;</div><div class="line">	return stickiesArray;</div><div class="line">&#125;</div><div class="line">//创建其他键值，并且从用户界面得到所选颜色值，并且转换为HSL值，写入localStorage</div><div class="line">//stickyObj是一个对象，不同于数组了。对象是个很抽象的玩意，Everything is an object</div><div class="line">function createSticky ()&#123;</div><div class="line">	var stickiesArray = getStickiesArray();</div><div class="line">	var currentDate = new Date();//按照时间获得一个随机数，保证键值不重复</div><div class="line">	var colorSelectObj = document.getElementById(&amp;quot;note_color&amp;quot;);</div><div class="line">	var index = colorSelectObj.selectedIndex;</div><div class="line">	var colorName = colorSelectObj[index].value;</div><div class="line">	var colorHSL = colorNameToHSL(colorName);</div><div class="line">	var value = $(&amp;quot;#note_text&amp;quot;).val();</div><div class="line">	var key = &amp;quot;sticky_&amp;quot; + currentDate.getTime();</div><div class="line">	var stickyObj = &#123;</div><div class="line">		&amp;quot;value&amp;quot;: value,</div><div class="line">		&amp;quot;colorHSL&amp;quot;: colorHSL</div><div class="line">	&#125;</div><div class="line">	//将对象写入localStorage</div><div class="line">	localStorage.setItem(key, JSON.stringify(stickyObj));</div><div class="line">	//将键名添加到哪个神奇的母键的最后一项</div><div class="line">	stickiesArray.push(key);</div><div class="line">	localStorage.setItem(&amp;quot;stickiesArray&amp;quot;, JSON.stringify(stickiesArray));</div><div class="line">	//添加便贴到DOM</div><div class="line">	addStickyToDOM(key, stickyObj);</div><div class="line">&#125;</div><div class="line">//添加便贴到DOM的具体步骤，stickyObj是一个对象，要用.来访问子元素</div><div class="line">function addStickyToDOM (key, stickyObj)&#123;</div><div class="line">	var sticky = document.createElement(&amp;quot;li&amp;quot;);</div><div class="line">	sticky.setAttribute(&amp;quot;id&amp;quot;, key);</div><div class="line">	sticky.setAttribute(&amp;quot;style&amp;quot;, &amp;quot;background-color:hsl(&amp;quot; + stickyObj.colorHSL +&amp;quot;, 56%, 60%);&amp;quot;);//HSL中的色相保持随机，其他的固定上。保证颜色的饱和度和亮度</div><div class="line">	var span = document.createElement(&amp;quot;span&amp;quot;);</div><div class="line">	span.setAttribute(&amp;quot;class&amp;quot;, &amp;quot;sticky&amp;quot;);</div><div class="line">	span.innerHTML = stickyObj.value;</div><div class="line">	sticky.appendChild(span);</div><div class="line">	$(&amp;quot;#note_display_ul&amp;quot;).append(sticky);</div><div class="line">	sticky.onclick = deleteSticky;</div><div class="line">&#125;</div><div class="line">//删除即时贴的函数，做了一个判断，判断点击对象并确保为ul下的li元素，而不是span</div><div class="line">//同时还要更新删除过后的stickiesArray数组</div><div class="line">function deleteSticky (e)&#123;</div><div class="line">	if(confirm(&amp;quot;你确定要删除这个即时贴吗？&amp;quot;))&#123;</div><div class="line">		var key = e.target.id;</div><div class="line">		if(e.target.tagName.toLowerCase() == &amp;quot;span&amp;quot;) &#123;</div><div class="line">			key = e.target.parentNode.id;</div><div class="line">		&#125;</div><div class="line">		localStorage.removeItem(key);</div><div class="line">		var stickiesArray = getStickiesArray();</div><div class="line">		if(stickiesArray) &#123;</div><div class="line">			for (var i = 0; i&amp;lt; stickiesArray.length; i++) &#123;</div><div class="line">				if(key == stickiesArray[i])&#123;</div><div class="line">					stickiesArray.splice(i,1);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			localStorage.setItem(&amp;quot;stickiesArray&amp;quot;, JSON.stringify(stickiesArray));</div><div class="line">			removeStickyFromDom(key);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">//从DOM中删除已经删除的便贴</div><div class="line">function removeStickyFromDom(key) &#123;</div><div class="line">	var sticky = document.getElementById(key);</div><div class="line">	sticky.parentNode.removeChild(sticky);</div><div class="line">&#125;</div><div class="line">//将colorName根据HSL的颜色值进行分析并返回</div><div class="line">function colorNameToHSL(colorName) &#123;</div><div class="line">	if(colorName == &amp;quot;科技蓝&amp;quot;) &#123;</div><div class="line">		return 200;</div><div class="line">	&#125;</div><div class="line">	else if (colorName == &amp;quot;淡雅黄&amp;quot;)&#123;</div><div class="line">		return 60;</div><div class="line">	&#125;</div><div class="line">	else if (colorName == &amp;quot;清新绿&amp;quot;)&#123;</div><div class="line">		return 100;</div><div class="line">	&#125;</div><div class="line">	else if (colorName == &amp;quot;暧昧粉&amp;quot;)&#123;</div><div class="line">		return 325;</div><div class="line">	&#125;</div><div class="line">	else if (colorName == &amp;quot;高贵紫&amp;quot;)&#123;</div><div class="line">		return 250;</div><div class="line">	&#125;</div><div class="line">	else&#123;</div><div class="line">		var random_num = Math.floor(Math.random()*359+1);</div><div class="line">		return random_num;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>

    <div class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/科技改变生活/"> #科技改变生活 </a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2013/02/08/数据库及SQL学习笔记总结/">数据库及SQL学习笔记总结</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2013/01/19/响应式Web设计：HTML5和CSS3【让你的网站兼容各个平台】/">响应式Web设计：HTML5和CSS3【让你的网站兼容各个平台】</a>
            
          </div>
        </div>
      

      
      
    </div>
  </div>



    <div class="post-spread">
      
    </div>

    
      <div class="comments" id="comments">
        
          <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          </div>
        
      </div>
    
  </div>


        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview"  style="display: block;" >
        <div class="site-author motion-element">
          <img class="site-author-image" src="https://avatars3.githubusercontent.com/u/3196361?v=3&s=460" alt="Vanilla" />
          <p class="site-author-name">Vanilla</p>
        </div>
        <p class="site-description motion-element">晓风博客是一个以技术成长、设计生活、个人心得为主题的个人博客，旨在与你分享生活点滴，共同成长。</p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">168</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            
              <span class="site-state-item-count">104</span>
              <span class="site-state-item-name">标签</span>
              
          </div>

        </div>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml">
              <i class="menu-item-icon icon-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="https://github.com/liyaodong" target="_blank">github</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://twitter.com/xiaofengdong" target="_blank">twitter</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://weibo.com/lyd19941020" target="_blank">weibo</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.zhihu.com/people/liyaodong" target="_blank">zhihu</a>
            </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name"></p>
            
              <span class="links-of-author-item">
              <a href="http://cloudy9101.github.io/" target="_blank">Cloudy9101</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://blog.ligan.me/" target="_blank">Gavin's Blog</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://zkuns.github.io/" target="_blank">Zkun's blog</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://www.nczonline.net/blog/" target="_blank">NCZOnline</a>
              </span>
            
          
        </div>

      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp;  2012 - 
  2017
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Vanilla</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  
  

  
  <script type="text/javascript" src="/vendors/jquery-pjax/jquery.pjax.js?v=0.4.4"></script>
  <script type="text/javascript" src="/vendors/nprogress/nprogress.js?v=0.4.4"></script>
  <link rel="stylesheet" href="/vendors/nprogress/nprogress.css?v=0.4.4">
  <script type="text/javascript" src="/js/pjax-config.js"></script>


  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.4"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.4"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.4" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>

  
  


  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  

  

  

    <script type="text/javascript">
      var disqus_shortname = 'xiaofengblog';
      var disqus_identifier = '2013/02/05/基于HTML5-localStorage的便利贴/';
      var disqus_title = '基于HTML5 localStorage的便利贴';
      var disqus_url = 'http://liyaodong.com/2013/02/05/基于HTML5-localStorage的便利贴/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  <script type="text/javascript" src="/js/analytics_google-analytics.js?v=0.4.4"></script>


</body>
</html>
