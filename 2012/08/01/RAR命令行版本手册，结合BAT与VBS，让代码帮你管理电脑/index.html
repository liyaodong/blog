<!doctype html>
<html class="theme-next use-motion ">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.4"/>


    <meta name="description" content="晓风博客是一个以技术成长、设计生活、个人心得为主题的个人博客，旨在与你分享生活点滴，共同成长。" />



  <meta name="keywords" content="科技改变生活," />



  <link rel="alternate" href="/atom.xml" title="晓风博客" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.4" />


<meta content="晓风博客" property="og:site_name">
<meta content="RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑" property="og:title">
<meta content="http://liyaodong.com/2012/08/01/RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑/" property="og:url">
<meta content="article" property="og:type">
<meta content="晓风博客是一个以技术成长、设计生活、个人心得为主题的个人博客，旨在与你分享生活点滴，共同成长。" property="og:description">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    analytics: {
      google: 'UA-30027709-1'
    },
    sidebar: 'hide'
  };
</script>




  <title> RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑 // 晓风博客 </title>
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>
</head>

<body>
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  <div class="container one-column page-post-detail">
    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <span class="logo windmill-logo">
    <i class="windmill-top"></i>
    <i class="windmill-dot"></i>
    <i class="windmill-base"></i>
  </span>
  <a href="/" class="brand windmill-hover">
    <span class="site-title">晓风博客</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<div class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/">
            <i class="menu-item-icon icon-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            <i class="menu-item-icon icon-archives"></i> <br />
            归档
          </a>
        </li>
      
    </ul>
  

  
</div>

      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          

  <div id="posts" class="posts-expand">
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于 2012-08-01
        </span>

        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2012/08/01/RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2012/08/01/RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        <p><a href="http://liyaodong.qiniudn.com/uploads/2012/08/android-robots-green-500.jpg" target="_blank" rel="external"><img src="http://liyaodong.qiniudn.com/uploads/2012/08/android-robots-green-500.jpg" alt="android-robots-green" title="android-robots-green"></a></p>
<p>最近要管理学校的服务器，有很多重复性的工作需要做，比如清理垃圾、备份数据库等等。。。所以尝试着编了一个BAT来处理这些，果然方便多了。<a id="more"></a></p>
<h3 id="我的bat源码："><a href="#我的bat源码：" class="headerlink" title="我的bat源码："></a>我的bat源码：</h3><p>[code lang=”c”]@echo off<br>e:<br>cd temp<br>del -f -a -s -q *<br>y<br>taskkill -f -im thunder.exe<br>taskkill -f -im SogouCloud.exe<br>taskkill -f -im thunderplatform.exe<br>taskkill -f -im chrome.exe<br>taskkill -f -im iexplore.exe<br>taskkill -f -im qq.exe<br>taskkill -f -im notepad.exe<br>c:\progra~1\WinRAR\winrar.exe a /agYY-MM-DD /k /r /s /ibck e:\backup.rar e:\youwebroot\database<br>echo ======================================== &gt;&gt; e:\log.txt<br>echo 清理日期： %date% &gt;&gt; e:\log.txt<br>echo 清理时间：%time:~0,5% &gt;&gt; e:\log.txt<br>echo 垃圾文件及垃圾进程及文件备份清理完毕 &gt;&gt; e:\log.txt<br>echo ======================================== &gt;&gt; e:\log.txt<br>exit [/code]</p>
<p>下面解释代码的意思：首先移动到e盘的temp文件夹下，并利用del命令清空文件夹，然后用taskkill命令清除常见多余进程。然后就是数据库备份了，一个winrar命令行版本的，用来将e:\youwebroot\database目录下所有文件压缩到e:\backup.rar，其中.rar是文件名。嗯(⊙_⊙)？.rar怎么会是文件名呢？其实是前面的参数/agYY-MM-DD起了作用，这个参数的意思就是以年份-月份-日期来命名文件。当然你也可以给.rar前面加东西，比如backup.rar，那么生成的文件就是backup12-08-01.rar。很方便，不是么？而最后的几行代码是用来给e:\log.txt下记录备份信息的。整个bat就是这个样子了。然后再控制面板计划任务中设置让程序每天几点运行，我是让它在三点运行的。以后每天只需要去e盘查看log.txt备份记录，如果数据库有问题了也只需要到e:\backup下找压缩文件就OK了。整个程序来说没有多大技术含量，因为这只是一个演示，你可以用这种思路干许多事情~  比如自动挂QQ啦~ 自动刷空间啦~ 自动挂游戏账号啦~ 自动下载软件啦~ 结合vbs后可以干更多的事情，自己慢慢探索吧~  最后奉上我的log.txt和WINRAR命令行版本的手册~</p>
<h3 id="我的log-txt"><a href="#我的log-txt" class="headerlink" title="我的log.txt"></a>我的log.txt</h3><pre>========================================
清理日期： 2012-07-29 星期日
清理时间： 3:00
垃圾文件及垃圾进程及文件备份清理完毕
========================================
========================================
清理日期： 2012-07-30 星期一
清理时间： 3:00
垃圾文件及垃圾进程及文件备份清理完毕
========================================
========================================
清理日期： 2012-07-31 星期二
清理时间： 3:00
垃圾文件及垃圾进程及文件备份清理完毕
========================================
========================================
清理日期： 2012-08-01 星期三
清理时间： 3:00
垃圾文件及垃圾进程及文件备份清理完毕
========================================</pre>

<h3 id="Winrar命令行版本手册"><a href="#Winrar命令行版本手册" class="headerlink" title="Winrar命令行版本手册"></a>Winrar命令行版本手册</h3><p>用法: rar &lt;命令&gt; -&lt;开关 1&gt; -&lt;开关 N&gt; &lt;压缩文件&gt; &lt;文件…&gt;<br>&lt;@列表文件…&gt; &lt;解压路径\&gt;</p>
<p>&lt;命令&gt;<br>a 添加文件到压缩文件<br>c 添加压缩文件注释<br>cf 添加文件注释<br>ch 改变压缩文件参数<br>cw 写入压缩文件注释到文件<br>d 删除压缩文件中的文件<br>e 解压压缩文件到当前目录<br>f 刷新压缩文件中的文件<br>i[参数]=&lt;串&gt; 在压缩文件中查找字符串<br>k 锁定压缩文件<br>l[t,b] 列出压缩文件[技术信息,简洁]<br>m[f] 移动到压缩文件[仅对文件]<br>p 打印文件到标准输出设备<br>r 修复压缩文件<br>rc 重建丢失的卷<br>rn 重命名压缩文件<br>rr[N] 添加数据恢复记录<br>rv[N] 创建恢复卷<br>s[名字|-] 转换压缩文件为自解压格式或转换回压缩文件<br>t 测试压缩文件<br>u 更新压缩文件中的文件<br>v[t,b] 详细列出压缩文件[技术信息,简洁]<br>x 用绝对路径解压文件</p>
<p>&lt;开关&gt;</p>
<ul>
<li>停止扫描<br>ac 压缩或解压后清除存档属性<br>ad 添加压缩文件名到目标路径<br>ag[格式] 使用当前日期生成压缩文件名<br>ao 添加具有压缩属性的文件<br>ap&lt;格式&gt; 添加路径到压缩文件中<br>as 同步压缩文件内容<br>av 添加用户身份校验(仅注册版本可用)<br>av- 禁用用户身份校验<br>c- 禁用注释显示<br>cfg- 禁用读取配置<br>cl 名称转换为小写<br>cu 名称转换为大写<br>df 压缩后删除文件<br>dh 打开共享文件<br>ds 对固实压缩文件禁用名称排序<br>e[+]&lt;属性&gt; 设置文件排除和包括属性<br>ed 不添加空目录<br>en 不添加”压缩文件结束”标志<br>ep 从名称中排除路径<br>ep1 从名称中排除基本目录<br>ep2 展开为完整路径<br>ep3 扩展路径为包含盘符的完全路径<br>f 刷新文件<br>fcu[文件] 从 Unicode 文件读取压缩文件注释<br>hp[密码] 同时加密文件数据和文件头<br>id[c language=”,d,p,q”][/c] 禁用消息<br>ieml[属性] 用 E-mail 发送压缩文件<br>ierr 发送所有消息到标准错误设备<br>ilog[名称] 把错误写到日志文件(只有注册版本可用)<br>inul 禁用所有消息<br>ioff 完成一个操作后关闭 PC 电源<br>isnd 启用声音<br>k 锁定压缩文件<br>kb 保留损坏的已解压文件<br>m&lt;0..5&gt; 设置压缩级别(0-存储…3-默认…5-最大)<br>mc&lt;参数&gt; 设置高级压缩参数<br>md&lt;大小&gt; 以KB为单位的字典大小(64,128,256,512,1024,2048,4096 or A-G)<br>ms[ext;ext] 指定存储的文件类型<br>mt&lt;线程&gt; 设置线程数<br>n&lt;文件&gt; 仅包含指定的文件<br>n@ 从标准输入设备读取文件名到包括<br>n@&lt;列表&gt; 在指定的文件列表包括文件<br>o+ 覆盖已存在文件<br>o- 不覆盖已存在文件<br>oc 设置 NTFS 压缩属性<br>or 自动重命名文件<br>os 保存 NTFS 流<br>ow 保存或恢复文件所有者和组<br>p[密码] 设置密码<br>p- 不询问密码<br>r 递归子目录<br>r0 仅递归通配符名称的子目录<br>ri&lt;P&gt;[:&lt;S&gt;] 设置优先级(0-默认,1-最小..15-最大)和以毫秒为单位的休眠时间<br>rr[N] 添加数据恢复记录<br>rv[N] 创建恢复卷<br>s[&lt;N&gt;,v[-],e] 创建固实压缩文件<br>s- 禁用固实压缩文件<br>sfx[名称] 创建自解压压缩文件<br>st[名称] 从标准输入设备读取数据(stdin)<br>sl&lt;大小&gt; 处理小于指定大小的文件<br>sm&lt;大小&gt; 处理超过指定大小的文件<br>t 压缩后测试文件<br>ta&lt;日期&gt; 添加日期 &lt;日期&gt; 后修改的文件,日期格式 YYYYMMDDHHMMSS<br>tb&lt;日期&gt; 添加日期 &lt;日期&gt; 前修改的文件,日期格式 YYYYMMDDHHMMSS<br>tk 保留原始压缩文件时间<br>tl 设置压缩文件时间为最新文件时间<br>tn&lt;时间&gt; 添加 &lt;时间&gt; 以后的文件<br>to&lt;时间&gt; 添加 &lt;时间&gt; 以前的文件<br>ts&lt;m,c,a&gt;[N] 保存或恢复文件时间(修改,创建,访问)<br>u 更新文件<br>v 自动检测创建卷的大小或者列出所有的卷<br>v&lt;大小&gt;[k,b] 创建卷大小=&lt;大小&gt;<em>1000 [</em>1024, *1]<br>vd 创建容量前清除磁盘内容<br>ver[n] 文件版本控制<br>vn 使用旧风格的卷命名方案<br>vp 每卷之前暂停<br>w&lt;路径&gt; 指定工作目录<br>x&lt;文件&gt; 排除指定的文件<br>x@ 从标准输入设备读取要排除的文件名<br>x@&lt;列表&gt; 排除指定列表文件中的文件<br>y 假设对全部询问都回答是<br>z[文件] 从文件读取压缩文件注释</li>
</ul>
<p>RAR 命令行语法<br><del>~</del><del>~</del>~~~~<br>语法：RAR &lt;命令&gt; [ -&lt;开关&gt; ] &lt;压缩文件&gt; [ &lt;@列表文件…&gt; ]<br>[ &lt;文件…&gt; ] [ &lt;解压路径\&gt; ]<br>描述：<br>命令行选项 (命令和开关) 提供了使用 RAR<br>创建和管理压缩文件的控制方法。命令是一个字符串(或单个的字母)，命令RAR去执行一个相应的操作。开关被用来改变RAR执行操作的方法。其它参数是压缩文件名和被压缩的文件或要从压缩文件中被解压文件。列表文件是一个包括处理的文件名的纯文本文件。第一列应该以文件名开始。可以在//字符后添加注释。例如，你可以创建包含下列字符串的backup.lst:</p>
<p>c:\work\doc*.txt //备份文本文档<br>c:\work\image*.bmp //备份图片<br>c:\work\misc<br>接着运行: rar a backup @backup.lst<br>如果你希望从标准输入设备读取文件名,指定空的文件列表名(只有@)。 在列表文件中 Win32控制台RAR使用OEM (DOS) 编码。<br>你可以在同一命令行指定普通文件名和列表文件。如果文件和列表 文件都未被指定，那么RAR将默认是<br><em>.</em>，来处理所有文件。在一个UNIX环境变量中，你需要将通配符置于引号中，避免被外壳扩展。例如，这个命令将从当前路径中的 RAR<br>压缩文件解压所有的<em>.asm文件: rare’</em>.rar’’*.asm’<br>命令可以是下列中的任何一个:<br>a 添加文件到压缩文件中。<br>例子: 创建或更新已存在的压缩文件myarch，添加当前目录中的所有文件<br>rar a myarch</p>
<p>c 添加压缩文件注释。当压缩文件被处理时注释被显示。文件的注释长度限制到 32767字节。例子: rar c distrib.rar 注释也可以从文件添加:</p>
<p>rar c -zinfo.txt dummy</p>
<p>cf 添加文件注释。当使用’v’命令时显示文件注释。文件的注释长度限制到 32767字节。<br>例子: rar cf bigarch *.txt<br>cw 写压缩文件注释到指定文件。<br>例子: rar cw oldarch comment.txt</p>
<p>d 从压缩文件中删除文件。注意，如果这个命令导致压缩文件中所有文件全部删除，这个空的压缩文件将被删除。<br>e 解压文件到当前目录。<br>f 更新压缩文件中的文件。更新打包到压缩文件后被改变的文件。这个命令不向压缩文件中添加新文件。<br>i[i|c|h|t]=&lt;字符串&gt; 在压缩文件中查找字符串。 支持下列可选参数:<br>i - 不区分大小写(默认);<br>c - 区分大小写搜索;<br>h - 十六进制搜索;<br>t - 使用ANSI, Unicode和OEM字符表(只有Win32可用);<br>如果没有指定任何参数，它可以使用简化的命令行语法i&lt;字符串&gt;来代替i=&lt;字符串&gt;。它允许指定带有另外一个参数的’t’变量，例如，ict=字符串在上面提及的所有表中执行区分大小写的搜索。</p>
<p>例子: 1) rar “ic=first level” -r c:*.rar <em>.txt 在 c:\</em>.rar压缩文件中的*.txt<br>文件执行区分大小写的”first level”字符串的搜索<br>2) rar ih=f0e0aeaeab2d83e3a9 -r e:\text 在 e:\text 目录下的 rar 压缩文件中搜索十六进制字符串f0 e0<br>ae ae ab 2d 83 e3 a9。<br>k 锁定压缩文件。任何试图改变压缩文件的命令都会被忽略。<br>例子: rar k final.rar<br>l[t,b]<br>压缩文件的内容列表[技术信息]。和’v’命令一样列出文件，但不包括文件路径。也就是只显示文件名。当使用’t’修正时可选技术信息(主操作系统，固实标志和老版本标记)被显示。变量’b’强制RAR只输出单纯的文件名，而没有其他任何的附加信息。</p>
<p>m[f] 移动到压缩文件中[只用于文件]。移动文件和目录会使压缩操作完成后它们被删除。如果使用修正’f’和/或应用开关’-ed’，则不删除目录。<br>p 打印文件到标准输出设备。你可以把这个命令和 -inul<br>开关一起是用来禁止所有的RAR信息，并只打印文件数据。当你需要发送一个文件到标准输出设备时，这也许很重要。<br>r<br>修复压缩文件。压缩文件修复是在两阶段中完成的。首先，在损坏的压缩文件中查找恢复记录(参照’rr’命令)。如果压缩文件包含恢复记录，并且损坏数据部分是连续的，而且少于N*512字节(N处是放入压缩文件恢复块的数字),则成功恢复压缩文件的机会非常高。当这个阶段完成，一个新的压缩文件将被创建，名为_RECOVER.RAR。如果损坏的压缩文件不包含恢复记录或如果压缩文件没有完全恢复导致大的损伤，将执行第二阶段。这一阶段期间只重建压缩文件的结构，而不可能恢复<br>CRC 校验失败的文件。它仍然可能恢复不在受损部位，而文件结构破坏的文件。这对于非固实压缩文件通常有用。当第二阶段完成，重建结构的压缩文件将被保存为<br>rebuilt.arcname.rar, ‘arcname’ 的位置是原始压缩文件名。<br>RAR/DOS32版本使用_recover.rar和_reconst.rar而不是上面提及的名字。<br>随着恢复记录的提高，当发现可疑文件时，RAR 可以提示用户。<br>名字: &lt;可能的文件名&gt;<br>大小: &lt;大小&gt; 压缩后: &lt;压缩后大小&gt;<br>添加它: 是/否/全部 回答’y’来把这个项目添加到文件_RECOVER.RAR中。<br>例子: rar r buggy.rar<br>rc 使用恢复卷(.rev 文件)重建丢失的卷。你需要指定任何已存在的卷作为压缩文件名，例如，’rar rc backup.part03.rar’。读取<br>‘rv’ 命令描述得到关于恢复卷的信息。<br>rn 重命名压缩文件。命令语法是:<br>rar rn &lt;压缩文件名&gt; &lt;源文件名1&gt; &lt;目标文件名1&gt; … &lt;源文件名N&gt; &lt;目标文件名N&gt; 例如，下列命令:<br>rar rn data.rar readme.txt readme.bak info.txt info.bak<br>在压缩文件data.rar中将把readme.txt重命名为readme.bak并把info.txt重命名为info.bak。在源文件和目标文件名中可以使用统配符来进行简单像改变文件扩展名的名称转换。例如:</p>
<p>rar rn data.rar <em>.txt </em>.bak 将把所有的 <em>.txt 文件重命名为
</em>.bak。RAR不检查目标文件名是否已经在压缩文件中存在，所以你需要小心，防止重名。尤其是使用统配符时特别重要。这个命令有潜在的危险，因为一个错误的统配符可以损坏所有的压缩文件名。</p>
<p>rr[N]<br>添加数据恢复记录。可选，多余信息(恢复记录)可以被添加到压缩文件中。这将导致压缩文件大小稍微增加，但能在软盘错误或其它数据丢失情况下帮助恢复压缩文件。一个恢复记录最大包含524288个恢复块。块的数目可以在’rr’(N<br>= 1，2 .. 524288)命令中直接指定或不用用户指定，而是根据压缩文件的大小自动设定：一个恢复信息大小大约是总<br>压缩文件大小的1%，通常允许恢复达到压缩文件总大小的0.6%的连续数据。也可以以压缩文件大小的百分比来指定恢复记录的大小。只要把%添加到命令参数后。例如:<br>rar rr3% arcname<br>注意，如果你从.bat或.cmd文件运行这个命令时，你需要使用rr3%%代替rr3%，因为批处理命令把符号’%’作为批处理文件开始的参数。你可以使用 ‘p’<br>代替’%’，所以’rr3p’也可运行。如果受损的数据是连续性的，则每个恢复记录块帮助恢复损坏信息的512字节。如果多处损坏这个值将降低。恢复记录的大小可以使用公式&lt;压缩文件大小&gt;/256</p>
<ul>
<li>&lt;恢复记录数&gt;*512字节估计。<br>rv[N] 创建恢复卷(.rev文件)，以后它可以用于重建卷组中丢失的文件。这个命 令只对多卷压缩文件敏感，你需要在组中指定第一个分卷文件的文件名。<br>例如: rar rv3 data.part01.rar<br>这个功能可以被用来备份，例如，发送一个多卷压缩文件到一个新组，并且部分接收者没有收其中的一些文件。重新发送恢复卷代替普通卷，可以减少传送文件的总数。每个恢复卷可以重建一个丢失的<br>RAR<br>卷。例如，如果你有30个卷，3个恢复卷，你可以创建任何3个丢失的卷。如果.rev文件的数目少于丢失卷的数目，重建将不可能。普通和恢复卷的总数不能超过255。</li>
</ul>
<p>选项&lt;N&gt;参数指定创建恢复卷的数目，必须少于RAR卷的总数。你也可以附加一个百分号到这个参数上，这样创建的.rev文件的数目将等于从RAR卷总数获得的这个百分比。例如:<br>rar rv15% data.part01.rar</p>
<p>RAR不管是使用‘rc’命令或自动时，如果在解压时无法定位下一卷，并且发现可用数目的.rev文件，对丢失的卷和损坏的卷都试图重建。损坏卷的原始副本在被重建前重命名为*.bad。例如，volname.part03.rar将被重命名为volname.part03.rar.bad。</p>
<p>s[名称] 转换压缩文件成自解压格式。压缩文件和自解压模块合并(使用<br>default.sfx模块或在开关中指定)。在Windows版本中default.sfx应该放在RAR.exe所在目录下，在Unix中在用户的home目录中，在<br>/usr/lib或 /usr/local/lib下。<br>s- 从已存在的自解压压缩文件中删除自解压模块。RAR 创建一个不带自解压模块的新的压缩文件，原来的自解压文件不会被删除。<br>t 测试压缩文件。为了验证指定的文件，这个命令执行虚拟的文件解压操作， 不写出任何输出数据流。例子: 在当前目录测试压缩文件: 或对于Unix: rar t<br>‘<em>‘<br>当前目录开始，测试所有子目录下的压缩包： rar t -r </em><br>或对于 Unix: rar t -r ‘<em>‘<br>u 更新压缩文件中的文件。添加不在压缩文件中的文件和更新打包后改变了的文件。<br>v[t,b]<br>详细列出压缩文件内容[技术信息]。文件列出所使用的格式:绝对路径名，文件注释，原始和压缩后的大小，压缩率，最近更新日期和时间，属性，CRC，压缩方式和解压所需的最小RAR版本。当使用’t’修改时可选技术信息(主操作系统，固实标志和老的文件版本标记)显示。变量’b’强制RAR只输出单纯的文件名，而没有其他任何的附加信息。列出所有压缩卷的内容，使用星号(‘</em>‘)代替压缩文件扩展名或使用’-v’开关。</p>
<p>例子: 写压缩文件内容列表(技术信息)到一个文件中<br>rar vt bambam &gt;bambam.lst<br>x 带绝对路径解压。 例子:<br>1) 列出 system.rar 压缩文件的内容 (技术模式)并使用重定向符输出 到文件techlist.lst中 rar vt system<br>&gt;techlist.lst<br>2) 列出 tutorial.rar压缩文件的内容 (单纯文件名模式)<br>rar vb tutorial<br>开关 (与命令结合使用):<br>-? 显示命令和开关的帮助。和没有参数或输入非法命令行选项时相同。<br>– 停止开关扫描。 这个开关告诉 RAR<br>命令行中没有更多的开关了。如果压缩文件或文件名以-符号开头，可以使用它。没有’–’开关，这样的名字将被作为开关对待。例子:<br>从当前目录添加所有文件到固实压缩文件’-StrangeName’<br>RAR a -s – -StrangeName<br>-ac 压缩或解压后清除存档属性(只有Windows版本可用).<br>-ad 附加压缩文件名到目标路径中。<br>这个选项可以在解压一组压缩文件时使用。默认条件下 RAR<br>把从压缩文件中解压的文件放在同一目录下，但是这个开关使从每个压缩文件中解压的文件都创建一个单独的目录。例子: rar x -ad *.rar data\<br>RAR将每一个未压缩的压缩文件在’data’下创建子目录。<br>-ag[格式] 使用当前的日期和时间产生压缩文件名。<br>当创建压缩文件时附加当前日期字符串到压缩文件名上。用于每日备份。附加的字符串格式有几种可选的格式参数定义或使用”YYYYMMDDHHMMSS”。字符串的格式可以包含下列字符:</p>
<p>Y - 年<br>M - 月<br>MMM - 使用文本字符串作为月名(Jan，Feb，等.)<br>W - 年的第几周 (每星期从星期一开始)<br>A - 星期几 (星期一 -1，星期日 - 7)<br>D - 月的第几天<br>E - 年的第几天<br>H - 小时<br>M - 分 (如果在小时后，被作为分钟对待)<br>S - 秒<br>N - 压缩文件数。<br>RAR搜索要生成的名字的文件是否存在，如果发现它已经存在，将递增一个压缩文件数字，直到生成一个唯一的名字。如果在格式化字符串的第一个字符是’+’，日期字符串和基本压缩文件名位置交换，所以日期将在压缩文件名之前。</p>
<p>格式字符串可以包含在’{‘和’}’包含的可选字符。此文本插入到压缩文件名中。所有其它字符被不变地添加到文件名上。如果你需要更新已经存在的压缩文件，小心使用-ag开关。依赖于以前使用的-ag传送的格式字符串和时间，生成的和现有的压缩文件名可能不匹配。在这种情况下RAR会创建一个新的压缩文件，而不是更新现有文件。</p>
<p>例子:<br>1) 使用默认 YYYYMMDDHHMMSS 格式<br>rar a -ag backup<br>2) 使用 DD-MMM-YY 格式<br>rar a -agDD-MMM-YY backup<br>3) 使用 YYYYMMDDHHMM 格式，替换’backup’之前的日期<br>rar a -ag+YYYYMMDDHHMM backup<br>4) 使用 YYYY-WW-A 格式，包含区段描述<br>rar a -agYYYY{year}-WW{week}-A{wday} backup<br>5) 使用 YYYYMMDD 和压缩文件数。它允许你你在同一天使用-agyymmdd-nn 数次，每一个新的压缩文件名都将包含一个新的递增数字。<br>rar a -agYYYYMMDD-NN backup<br>-ao 添加带有存档属性的文件 (只有Windows版本可用).<br>例子: 添加C:上所有带有存档属性的文件到’f:backup’，并清除文件存档属性<br>rar a -r -ac -ao f:backup c:*.<em><br>-ap 压缩文件内部设置路径。当添加文件到文件中时，路径被整合到文件名中，<br>解压时从文件名删除。例如，如果你希望添加文件’readme.txt’到目录压缩文件’release’的’DOCS\ENG’中，你可以运行: rar a<br>-apDOCS\ENG release readme.txt<br>或者解压’ENG’到当前目录中: rar x -apDOCS release DOCS\ENG\</em>.<em><br>-as 同步压缩文件内容<br>如果压缩时使用这个开关，这些在当前被添加文件列表中不存在的被压缩文件将从压缩文件中删除。它对于使用这个开关和-u(更新)组阁同步一个压缩文件和正在压缩目录的内容很便利。例如，执行这个命令后:<br>rar a -u -as backup sources\</em>.cpp</p>
<p>压缩文件’backup.rar’将只包含目录’sources’中的*.cpp文件，所有其它文件将被从压缩文件中删除。它和创建新的压缩文件很相像，但是有一个重要的不同:如果最近备份之后没有文件被修改，这个操作执行得创建新的压缩文件快。</p>
<p>-av 添加身份校验(只有注册版本可用)。RAR将在每次新建或更新压缩文件时<br>添加关于创建者的信息、最后更新时间和压缩文件名。如果一个包含身份校验的压缩文件被修改，而没有指定这个开关，则身份校验信息将被删除。使用’-av’开关的压缩文件当解压、测试、列表或更新时，RAR将进行完整性确认并显示信息:</p>
<p>校验身份信息…<br>在成功校验身份的情况下，显示消息’确定’，创建者的名字和最近更新信息会被显示。在身份校验失败的情况下，将显示’失败’。用户身份校验功能，’-av’，在软件发布环境中推荐使用。<br>为了启用身份校验功能，程序必须注册。请联系你当地的发布点或网站发布中心。<br>-av- 禁止检查或添加身份校验。<br>-cfg- 忽略配置文件和 RAR 环境变量。<br>-cl 转换文件名成小写字母。<br>-cu 转换文件名成大写字母。<br>-c- 禁止显示注释。<br>-df 压缩后删除文件<br>移动文件到压缩文件中。这个开关与命令’A’组合执行和命令’M’时同一动作。<br>-dh<br>打开共享文件，允许处理有其它应用程序打开写的文件。如果应用程序允许对文件的读取访问，这个开关有效。但是如果文件的访问类型是私有，文件打开操作仍然会失败。这个选项很危险，因为它允许压缩一个文件，而同时正被其它应用程序修<br>改，所以小心使用。<br>-ds 添加到一个固实压缩文件是不排序。<br>-ed 不添加空目录，这个开关指出空目录不被存储到被创建的压缩文件中。当解压这样一个压缩文件时,<br>RAR会基于他们内部的文件路径创建非空的目录。关于空目录的信息丢失。非空目录除了名字外(访问权限, 流, 等。)其他所有属性全部丢失,<br>所以只有在你不需要保留这样的信息时使用此开关。<br>-ee 不处理扩展属性，禁止保存和修复扩展文件属性。只用于OS/2版本。<br>-en 不添加”压缩文件结束”块，默认情况下，RAR在新建或更新压缩文件时在结束时添加<br>“压缩文件结束”块。它允许跳过象数字安全签名等扩展数据，但是在一些特定条件下禁用这些功能可能有用。例如，如果在一个压缩文件通过不可靠的连接在两个系统之间传递，并且同时发送者在它里面添加新文件时，它可能对确认在传输过程中已经接收的部分不会被另一端所修改很重要。这个开关不能用在分卷上，因为压缩文件结束块包含正确处理卷的重要信息。</p>
<p>ps：</p>
<p>1.关于添加rar环境变量，可以新建一个vbs脚本</p>
<p>然后输入：strpath = cmd.Environment.Item( “PATH” ) &amp; “;C:\Program Files\WinRAR”<br>cmd.Environment.Item( “PATH” ) = strpath</p>
<p>保存运行就可以了。</p>
<p>2.关于隐藏bat运行的窗口，可以新建一个vbs，输入：</p>
<p>Option Explicit<br>On Error Resume Next<br>createobject(“wscript.shell”).run “c:\rar压缩.bat”,0<br>Dim wtime<br>wscript.sleep wtime*5<br>cmd.run “cmd /c attrib +h +s +a “c:\rar压缩.bat”,0<br>del rar压缩.bat</p>

      
    </div>

    <div class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/科技改变生活/"> #科技改变生活 </a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2012/08/02/是时候对IE6说再见了/">是时候对IE6说再见了~</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2012/08/01/《随梦成长》献给所有热爱生活，追逐理想的追梦之人/">《随梦成长》献给所有热爱生活，追逐理想的追梦之人~</a>
            
          </div>
        </div>
      

      
      
    </div>
  </div>



    <div class="post-spread">
      
    </div>

    
      <div class="comments" id="comments">
        
          <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          </div>
        
      </div>
    
  </div>


        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview"  style="display: block;" >
        <div class="site-author motion-element">
          <img class="site-author-image" src="https://avatars3.githubusercontent.com/u/3196361?v=3&s=460" alt="Vanilla" />
          <p class="site-author-name">Vanilla</p>
        </div>
        <p class="site-description motion-element">晓风博客是一个以技术成长、设计生活、个人心得为主题的个人博客，旨在与你分享生活点滴，共同成长。</p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">168</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            
              <span class="site-state-item-count">104</span>
              <span class="site-state-item-name">标签</span>
              
          </div>

        </div>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml">
              <i class="menu-item-icon icon-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="https://github.com/liyaodong" target="_blank">github</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://twitter.com/xiaofengdong" target="_blank">twitter</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://weibo.com/lyd19941020" target="_blank">weibo</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.zhihu.com/people/liyaodong" target="_blank">zhihu</a>
            </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name"></p>
            
              <span class="links-of-author-item">
              <a href="http://cloudy9101.github.io/" target="_blank">Cloudy9101</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://blog.ligan.me/" target="_blank">Gavin's Blog</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://zkuns.github.io/" target="_blank">Zkun's blog</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://www.nczonline.net/blog/" target="_blank">NCZOnline</a>
              </span>
            
          
        </div>

      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp;  2012 - 
  2017
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Vanilla</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  
  

  
  <script type="text/javascript" src="/vendors/jquery-pjax/jquery.pjax.js?v=0.4.4"></script>
  <script type="text/javascript" src="/vendors/nprogress/nprogress.js?v=0.4.4"></script>
  <link rel="stylesheet" href="/vendors/nprogress/nprogress.css?v=0.4.4">
  <script type="text/javascript" src="/js/pjax-config.js"></script>


  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.4"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.4"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.4" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>

  
  


  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  

  

  

    <script type="text/javascript">
      var disqus_shortname = 'xiaofengblog';
      var disqus_identifier = '2012/08/01/RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑/';
      var disqus_title = 'RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑';
      var disqus_url = 'http://liyaodong.com/2012/08/01/RAR命令行版本手册，结合BAT与VBS，让代码帮你管理电脑/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  <script type="text/javascript" src="/js/analytics_google-analytics.js?v=0.4.4"></script>


</body>
</html>
